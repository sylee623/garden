<!DOCTYPE html>
<html lang="en">
  <body>
    <nav><div>
    <a class="internal-link" href="/garden/"><b>Seoyeon Lee</b></a>
</div>
</nav>
    <div class="wrapper">
      <main><article>
  <div>
    <h1>Neural anticipation of virtual infection triggers an immune response</h1>
    <time datetime="2025-08-07T19:26:26+09:00">
      Last updated on August 7, 2025
      
    </time>
  </div>

  <div id="notes-entry-container">
    <content>
      <h1 id="neural-anticipation-of-virtual-infection-triggers-an-immune-response">Neural anticipation of virtual infection triggers an immune response</h1>
<h2 id="summary">Summary</h2>
<h3 id="ì €ì-ì •ë³´">ì €ì ì •ë³´</h3>
<p><strong>êµì‹ ì €ì</strong>:<br>
Camilla Jandus (ë©´ì—­í•™, University of Geneva)<br>
Andrea Serino (ì¸ì§€ì‹ ê²½ê³¼í•™, University of Lausanne)</p>

<hr>

<h3 id="ë…¼ë¬¸-ê¸°ë³¸-ì •ë³´">ë…¼ë¬¸ ê¸°ë³¸ ì •ë³´</h3>
<ul>
  <li>
<strong>ì €ì</strong>: Sara Trabanelli, Michel Akselrod, Julia Fellrath, Giulia Vanoni, et al.</li>
  <li>
<strong>ì†Œì†</strong>: University of Lausanne, University of Geneva ì™¸</li>
  <li>
<strong>ì €ë„</strong>: <em>Nature Neuroscience</em>
</li>
  <li>
<strong>ë°œí–‰ì—°ë„</strong>: 2025</li>
  <li>
<strong>DOI</strong>: <a href="https://doi.org/10.1038/s41593-025-02008-y" target="_blank">10.1038/s41593-025-02008-y</a>
</li>
</ul>

<hr>

<h3 id="tldr-">TL;DR ğŸ§ ğŸ’¥</h3>
<p>ê°€ìƒí˜„ì‹¤(VR)ì—ì„œ ê°ì—¼ ìœ„í˜‘ì„ ì˜ˆì¸¡í•˜ëŠ” ë‡Œ ë°˜ì‘ì´ ì‹¤ì œ ë©´ì—­ ë°˜ì‘ì„ ìœ ë„í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” peripersonal space(PPS) ì‹œìŠ¤í…œê³¼ HPA ì¶•ì„ ë§¤ê°œë¡œ í•˜ëŠ” ìƒˆë¡œìš´ ì‹ ê²½â€“ë©´ì—­ êµì°¨ ì‹ í˜¸ ê²½ë¡œë¥¼ ì‹œì‚¬í•œë‹¤.</p>

<hr>

<h3 id="ì£¼ìš”-ë°œê²¬-highlights-">ì£¼ìš” ë°œê²¬ (Highlights) ğŸŒŸ</h3>
<ul>
  <li>ê°ì—¼ ì§•í›„ê°€ ìˆëŠ” ì•„ë°”íƒ€ê°€ ì ‘ê·¼í•  ë•Œ, <strong><span title="There is no note that matches this link." class="invalid-link">  <span class="invalid-link-brackets">[[</span>  PPS  <span class="invalid-link-brackets">]]</span></span> ê´€ë ¨ ë‡Œ ì˜ì—­</strong>(ì „ìš´ë™, ë‘ì •ì—½, ACC ë“±)ì´ <strong>ë¨¼ ê±°ë¦¬ì—ì„œë„ ì¡°ê¸° í™œì„±í™”</strong>ë¨</li>
  <li>ì´ëŸ¬í•œ ë‡Œ ë°˜ì‘ì€ <strong>ê°ì—¼ì„± ì•„ë°”íƒ€ì™€ ì‹¤ì œ ë…ê° ë°±ì‹  ì ‘ì¢… ëª¨ë‘</strong>ì—ì„œ <strong><span title="There is no note that matches this link." class="invalid-link">  <span class="invalid-link-brackets">[[</span>  innate lymphoid cells (ILCs)ì˜ í™œì„± ë° ë¹ˆë„ ë³€í™”  <span class="invalid-link-brackets">]]</span></span></strong>ë¥¼ ìœ ë°œ
    <ul>
      <li>ì—¬ê¸°ì„œ ê¶ê¸ˆí•œì  ; ê·¸ëŸ¬ë©´ ì¼ë¶€ëŸ¬ PPS ë¥¼ í™œì„±í™” ì‹œì¼°ì„ë•Œë„ ILCì˜ í™œì„±ì´ ì •ê°€í•˜ë‚˜?</li>
    </ul>
  </li>
  <li>
<strong>fMRIì™€ DCM ë¶„ì„</strong>ì€ ê°ì—¼ ì˜ˆì¸¡ ì‹œ <strong>ì „ì „ë‘ì—½â€“ì‹œìƒí•˜ë¶€â€“HPA axis</strong> ê°„ì˜ ê¸°ëŠ¥ì  ì—°ê²°ì„± ì¦ê°€ë¥¼ ë³´ì—¬ì¤Œ</li>
  <li>
<strong>ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ ì‹ ê²½ë§ ëª¨ë¸</strong>ì€ í˜¸ë¥´ëª¬, eicosanoid, ì—¼ì¦ ì¸ìì˜ ë³µí•© ì‹ í˜¸ë¥¼ í†µí•´ ILC í™œì„±ë„ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì˜ˆì¸¡</li>
</ul>

<hr>

<h3 id="ë°©ë²•-methods-">ë°©ë²• (Methods) ğŸ”¬</h3>
<ul>
  <li>
<strong>ì°¸ê°€ì</strong>: ê±´ê°•í•œ ì„±ì¸ 248ëª…, ì—¬ëŸ¬ ë…ë¦½ ì½”í˜¸íŠ¸ (VR, EEG, fMRI, ë©´ì—­ë°˜ì‘, ë°±ì‹  ëŒ€ì¡°êµ° ë“±)</li>
  <li>
<strong>ìê·¹</strong>: ê°ì—¼, ì¤‘ë¦½, ê³µí¬ ì•„ë°”íƒ€ (VR í™˜ê²½ì—ì„œ ì œì‹œ)</li>
  <li>
<strong>ì¸¡ì •ê¸°ë²•</strong>:
    <ul>
      <li>í–‰ë™ ë°˜ì‘: ì–¼êµ´ ì´‰ê° ë°˜ì‘ ì‹œê°„ ê¸°ë°˜ PPS íŒŒì•…</li>
      <li>EEG (128ì±„ë„), fMRI (3T), Dynamic Causal Modeling</li>
      <li>Flow cytometry (ILC/NK cell ë¶„ë¥˜ ë° í™œì„±í™” ë§ˆì»¤)</li>
      <li>Mass spectrometry: HPA-related hormones, eicosanoids, neuroinflammatory markers</li>
      <li>Neural network ëª¨ë¸ë§: ë‹¤ì¤‘ ì‹ ê²½â€“ë©´ì—­ ì‹ í˜¸ ì…ë ¥ â†’ ILC í™œì„± ì˜ˆì¸¡</li>
    </ul>
  </li>
</ul>

<hr>

<h3 id="ì†Œì±•í„°ë³„-ë‚´ìš©-ìš”ì•½-">ì†Œì±•í„°ë³„ ë‚´ìš© ìš”ì•½ ğŸ“˜</h3>

<h4 id="-vr-ê°ì—¼-ìœ„í˜‘ì—-ëŒ€í•œ-pps-ë°˜ì‘">ğŸŸ¢ VR ê°ì—¼ ìœ„í˜‘ì— ëŒ€í•œ PPS ë°˜ì‘</h4>
<ul>
  <li>ê°ì—¼ì„± ì•„ë°”íƒ€ê°€ ë©€ë¦¬ì„œ ì ‘ê·¼í•  ë•Œë„ PPS íš¨ê³¼ê°€ í™•ì¥ë¨ â†’ ìœ„í—˜ ì˜ˆì¸¡ ë°˜ì‘ì˜ ê³µê°„ì  ë²”ìœ„ê°€ í™•ëŒ€ë¨</li>
</ul>

<h4 id="-eeg-ë¶„ì„">ğŸŸ¡ EEG ë¶„ì„</h4>
<ul>
  <li>129â€“150ms ì‚¬ì´ì— ê°ì—¼ ì•„ë°”íƒ€ì— ëŒ€í•œ <strong>Frontoâ€“Parietal ì˜ì—­ í™œì„±í™”</strong> í™•ì¸</li>
</ul>

<h4 id="-ë©´ì—­-ë°˜ì‘-ì¸¡ì •">ğŸ”´ ë©´ì—­ ë°˜ì‘ ì¸¡ì •</h4>
<ul>
  <li>ê°ì—¼ì„± ì•„ë°”íƒ€ ë…¸ì¶œ í›„ <strong>ILC ë¹ˆë„ ë° í™œì„±ë„ ì¦ê°€</strong>, ë°±ì‹  ì ‘ì¢… í›„ì™€ ìœ ì‚¬í•œ ë©´ì—­ í”„ë¡œíŒŒì¼</li>
  <li>íŠ¹íˆ <strong>ILC2, ILCP ì¦ê°€</strong>, ILC1 ê°ì†Œ (ì¡°ì§ ì´ë™ ê°€ëŠ¥ì„±)</li>
</ul>

<h4 id="-fmri-ë¶„ì„">ğŸ”µ fMRI ë¶„ì„</h4>
<ul>
  <li>
<strong>ë©€ë¦¬ ìˆëŠ” ê°ì—¼ì„± ì•„ë°”íƒ€</strong>ëŠ” aINS, mPFC, ACC ë“± <strong><mark>salience network</mark></strong>ì™€ <strong>S1</strong> í™œì„±í™” ìœ ë„</li>
  <li>
<mark>ê³µí¬ ì•„ë°”íƒ€ì™€ êµ¬ë³„</mark>ë˜ëŠ” ê°ì—¼-íŠ¹ì´ì  í™œì„±í™” íŒ¨í„´</li>
</ul>

<h4 id="-ì‹œìƒí•˜ë¶€-ì—°ê²°ì„±-ë¶„ì„-dcm">ğŸŸ£ ì‹œìƒí•˜ë¶€ ì—°ê²°ì„± ë¶„ì„ (DCM)</h4>
<ul>
  <li>ê°ì—¼ì„± ìê·¹ ì‹œ <strong><mark>ì‹œìƒí•˜ë¶€â€“salience/PPS ì˜ì—­ ê°„ ì—°ê²°ì„±</mark> ì¦ê°€</strong>
    <ul>
      <li>ê°ì—¼ì„± ìê·¹ì´ë¼ëŠ”ê²Œ ê°ì—¼ë³‘ í™˜ìê°€ ì˜¨ë‹¤ëŠ” ì–˜ê¸°?</li>
    </ul>
  </li>
  <li>íŠ¹íˆ ì¢Œì¸¡ ì „ì „ë‘ì—½ê³¼ ìš°ì¸¡ ì¼ì°¨ì²´ê°ê°í”¼ì§ˆì´ í•µì‹¬ ì—°ê²° ê²½ë¡œ</li>
</ul>

<h4 id="ï¸-ì‹ ê²½ë§-ëª¨ë¸ë§">âš™ï¸ ì‹ ê²½ë§ ëª¨ë¸ë§</h4>
<ul>
  <li>HPA ê´€ë ¨ í˜¸ë¥´ëª¬, eicosanoid, ì—¼ì¦ ì¸ì â†’ hidden layer ì‹ ê²½ë§ ì…ë ¥</li>
  <li>
<strong>ILC í™œì„±ë„ ì˜ˆì¸¡ ì •í™•ë„ RÂ² = 0.71</strong>, ê°ì—¼ ì½”í˜¸íŠ¸ëŠ” ì˜ˆì¸¡ì¹˜ hotspotì— ëª°ë¦¼
    <ul>
      <li>ì´ ë¶€ë¶„ì€ ë…¼ë¬¸ í™•ì¸ì´ ì¢€ ë” í•„ìš”í• ë“¯</li>
    </ul>
  </li>
</ul>

<hr>

<h3 id="discussion-ìš”ì•½-">Discussion ìš”ì•½ ğŸ§©</h3>
<ul>
  <li>
<strong>PPS ì‹œìŠ¤í…œ</strong>ê³¼ <strong>salience network</strong>ëŠ” ê°ì—¼ ì‹ í˜¸ë¥¼ ì‚¬ì „ì— ê°ì§€í•˜ê³  HPA ì¶•ì„ í†µí•´ ë©´ì—­ê³„ë¥¼ í™œì„±í™”í•  ìˆ˜ ìˆìŒ</li>
  <li>ì´ëŠ” <strong>í–‰ë™ ë©´ì—­ ì‹œìŠ¤í…œ(íšŒí”¼, ê±°ë¦¬ë‘ê¸°)</strong>ê³¼ <strong>ìƒë¬¼í•™ì  ë©´ì—­ ì‹œìŠ¤í…œ(ILC ë°˜ì‘)</strong>ì˜ í†µí•©ì  ì¡°ê¸° ë°˜ì‘ì„ ì‹œì‚¬</li>
  <li>ê°ì—¼ì„ ì˜ˆì¸¡í•˜ëŠ” <strong>â€˜ì—°ê¸° íƒì§€ê¸°â€™ ëª¨ë¸</strong>ê³¼ ìœ ì‚¬í•œ ìƒë¬¼í•™ì  ì›ë¦¬ ì œì•ˆ</li>
  <li>VR ê¸°ë°˜ ê°ì—¼ ìê·¹ë„ <strong>ì‹¤ì œ ë©´ì—­ í™œì„±í™”</strong>ë¥¼ ìœ ë„í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œ <strong>ì‹ ê²½â€“ë©´ì—­ ì—°êµ¬ ë° ì •ì‹ ì‹ ê²½ë©´ì—­í•™ ë¶„ì•¼ì— ìƒˆ ì´ì •í‘œ</strong>
</li>
</ul>

<hr>

<h3 id="ëª¨ë¸ì´-ì •ë¦¬í•œ-ì¶”ê°€-ì¸ì‚¬ì´íŠ¸-">ëª¨ë¸ì´ ì •ë¦¬í•œ ì¶”ê°€ ì¸ì‚¬ì´íŠ¸ ğŸ”</h3>
<ul>
  <li>ê°ì—¼ì„± ìœ„í˜‘ì— ëŒ€í•œ ì¡°ê¸° ë°˜ì‘ì´ ì‹¤ì œ ë©´ì—­ ë°˜ì‘ì„ ìœ ë„í•¨ìœ¼ë¡œì¨, <strong>ê°€ìƒ ì‹œë®¬ë ˆì´ì…˜ì„ í†µí•œ ì˜ˆë°©ì  ë©´ì—­ ê°•í™” ì „ëµ</strong>ì´ ê°€ëŠ¥í•  ìˆ˜ ìˆìŒ</li>
  <li>
<strong>PPS í™•ì¥ì„±</strong>ì€ ê°ì—¼ ê³µí¬ë¿ ì•„ë‹ˆë¼ <strong>ì‹¬ë¦¬ì‚¬íšŒì  ìŠ¤íŠ¸ë ˆìŠ¤ ìê·¹</strong>ì— ë”°ë¥¸ ë‡Œâ€“ë©´ì—­ ë°˜ì‘ ì—°êµ¬ì— í™•ì¥ë  ìˆ˜ ìˆìŒ</li>
  <li>ì‚¬íšŒì  íšŒí”¼ í–‰ë™ì´ ê°ì—¼ íšŒí”¼ë¿ ì•„ë‹ˆë¼ <strong>ë‚´ì¬ë©´ì—­ ì¡°ì ˆ ì „ëµ</strong>ìœ¼ë¡œ ì‘ë™í•œë‹¤ëŠ” ì ì„ ì‹¤í—˜ì ìœ¼ë¡œ ê²€ì¦</li>
</ul>

<h2 id="related-article">Related Article</h2>

<h2 id="abstract">Abstract</h2>
<blockquote>
  <p>[!Abstract]
Once contact with a pathogen has occurred, it might be too late for the immune system to react. Here, we asked whether anticipatory neural responses might sense potential infections and signal to the immune system, priming it for a response. We show that potential contact with approaching infectious avatars, entering the peripersonal space in virtual reality, are anticipated by multisensoryâ€“motor areas and activate the salience network, as measured with psychophysics, electroencephalography and functional magnetic resonance imaging. This proactive neural anticipation instigates changes in both the frequency and activation of innate lymphoid cells, mirroring responses seen in actual infections. Alterations in connectivity patterns between infection-sensing brain regions and the hypothalamus, along with modulation of neural mediators, connect these effects to the hypothalamicâ€“pituitaryâ€“adrenal axis. Neural network modeling recapitulates this neuroâ€“immune cross-talk. These findings suggest an integrated neuroâ€“immune reaction in humans toward infection threats, not solely following physical contact but already after breaching the functional boundary of bodyâ€“environment interaction represented by the peripersonal space.</p>
</blockquote>

      <p>This line appears after every note.</p>
    </content>

    <side style="font-size: 0.9em">
      <h3 style="margin-bottom: 1em">Notes mentioning this note</h3>
      

      <div style="font-size: 0.9em">
        <p>
          There are no notes linking to this note.
        </p>
      </div>
      
    </side>
  </div>
</article>

<hr>

<p>Here are all the notes in this garden, along with their links, visualized as a graph.</p>

<style>
  .links line {
    stroke: #ccc;
    opacity: 0.5;
  }

  .nodes circle {
    cursor: pointer;
    fill: #8b88e6;
    transition: all 0.15s ease-out;
  }

  .text text {
    cursor: pointer;
    fill: #333;
    text-shadow: -1px -1px 0 #fafafabb, 1px -1px 0 #fafafabb, -1px 1px 0 #fafafabb, 1px 1px 0 #fafafabb;
  }

  .nodes [active],
  .text [active] {
    cursor: pointer;
    fill: black;
  }

  .inactive {
    opacity: 0.1;
    transition: all 0.15s ease-out;
  }

  #graph-wrapper {
    background: #fcfcfc;
    border-radius: 4px;
    height: auto;
  }
  
  #graph-wrapper > svg {
    max-width: 100%;
    display: block;
  }
</style>

<div id="graph-wrapper">
  <script>
    window.addEventListener("load", loadGraph);

    function loadGraph() {
      var oScript = document.createElement("script");
      oScript.src = "https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js";
      oScript.crossOrigin = 'anonymous';
      oScript.integrity =
        "sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg==";
      document.body.appendChild(oScript);
      oScript.onload = () => {
        const MINIMAL_NODE_SIZE = 8;
        const MAX_NODE_SIZE = 12;
        const ACTIVE_RADIUS_FACTOR = 1.5;
        const STROKE = 1;
        const FONT_SIZE = 16;
        const TICKS = 200;
        const FONT_BASELINE = 40;
        const MAX_LABEL_LENGTH = 50;

        const graphData = {"edges":[{"source":"891111171143210210511411511632115101101100","target":"66111110329711211219516911610511633"},{"source":"891111171143210210511411511632115101101100","target":"6532110111116101329798111117116329997116115"},{"source":"891111171143210210511411511632115101101100","target":"84105103101114115"},{"source":"77111118101321211111171143298111100121321011181011141213210097121","target":"67111110115105115116101110991213210511532107101121"},{"source":"6532110111116101329798111117116329997116115","target":"77111118101321211111171143298111100121321011181011141213210097121"},{"source":"67111110115105115116101110991213210511532107101121","target":"891111171143210210511411511632115101101100"},{"source":"891111171143210210511411511632115101101100","target":"236149136235133149237149152236132184236154148"}],"nodes":[{"id":"66111110329711211219516911610511633","path":"/garden/accents","label":"Bon appÃ©tit!"},{"id":"6532110111116101329798111117116329997116115","path":"/garden/cats","label":"A note about cats"},{"id":"84105103101114115","path":"/garden/tigers","label":"Tigers"},{"id":"67111110115105115116101110991213210511532107101121","path":"/garden/consistency","label":"Consistency is key"},{"id":"77111118101321211111171143298111100121321011181011141213210097121","path":"/garden/move-your-body-every-day","label":"Move your body every day"},{"id":"7797110117115991141051121169511611111697108","path":"/garden/manuscript-total","label":"Manuscript_total"},{"id":"6510010010511610511111097108329711097108121115105115","path":"/garden/additional-analysis","label":"Additional analysis"},{"id":"50534855514895102114111109951151041141051091129511611195100111108112104105110","path":"/garden/250730-from-shrimp-to-dolphin","label":"250730_from_shrimp_to_dolphin"},{"id":"123123116105116108101125125","path":"/garden/journal-summary","label":""},{"id":"7311010010511810510011797108321001051021021011141011109910111532105110321001019910511510511111045109971071051101033211510497112101321041111193210910111511110810510998105993210011111297109105110101321141011031171089711610111532991041111059910132991111101021051001011109910132971101003299104971101031014511110245109105110100","path":"/garden/kocharianetalnatneurosci2025","label":"Individual differences in decision-making shape how mesolimbic dopamine regulates choice confidence and change-of-mind"},{"id":"65321021081011201059810810132104105112112111999710911297108321121111121171089711610511111032991111001013210211111432101120112101114105101110991013211410110897116105118101321161113211410111997114100","path":"/garden/sosaetalnatneurosci2025","label":"A flexible hippocampal population code for experience relative to reward"},{"id":"86111108116971031013210510997103105110103321141011181019710811532104105112112111999710911297108321051101041059810511611111412132100121110971091059911532115104971121051101033211212111497109105100971083210910110911111412145101110991111001051101033211510111311710111099101115","path":"/garden/taxidisetalnatneurosci2025","label":"Voltage imaging reveals hippocampal inhibitory dynamics shaping pyramidal memory-encoding sequences"},{"id":"6511032105110116101103114971161011003211510511010310810145110117991081011171153297110100321151129711610597108321161149711011599114105112116111109105991153297116108971153211410111810197108115321161041013210911110810199117108971143210897110100115999711210132111102321161041013210411710997110321041051121121119997109112117115","path":"/garden/thompsonetalnatneurosci2025","label":"An integrated single-nucleus and spatial transcriptomics atlas reveals the molecular landscape of the human hippocampus"},{"id":"78101117114971083297110116105991051129711610511111032111102321181051141161179710832105110102101991161051111103211611410510310310111411532971103210510910911711010132114101115112111110115101","path":"/garden/trabanellietalnatneurosci2025a","label":"Neural anticipation of virtual infection triggers an immune response"},{"id":"8710110899111109101","path":"/garden/welcome","label":"Welcome"},{"id":"891111171143210210511411511632115101101100","path":"/garden/your-first-note","label":"Your first seed"},{"id":"236149136235133149237149152236132184236154148","path":"/garden/%EC%95%88%EB%85%95%ED%95%98%EC%84%B8%EC%9A%94","label":"ì•ˆë…•í•˜ì„¸ìš”"}]}
        let nodesData = graphData.nodes;
        let linksData = graphData.edges;

        const nodeSize = {};

        const updateNodeSize = () => {
          nodesData.forEach((el) => {
            let weight =
              3 *
              Math.sqrt(
                linksData.filter((l) => l.source.id === el.id || l.target.id === el.id)
                  .length + 1
              );
            if (weight < MINIMAL_NODE_SIZE) {
              weight = MINIMAL_NODE_SIZE;
            } else if (weight > MAX_NODE_SIZE) {
              weight = MAX_NODE_SIZE;
            }
            nodeSize[el.id] = weight;
          });
        };

        const onClick = (d) => {
          window.location = d.path
        };

        const onMouseover = function (d) {
          const relatedNodesSet = new Set();
          linksData
            .filter((n) => n.target.id == d.id || n.source.id == d.id)
            .forEach((n) => {
              relatedNodesSet.add(n.target.id);
              relatedNodesSet.add(n.source.id);
            });

          node.attr("class", (node_d) => {
            if (node_d.id !== d.id && !relatedNodesSet.has(node_d.id)) {
              return "inactive";
            }
            return "";
          });

          link.attr("class", (link_d) => {
            if (link_d.source.id !== d.id && link_d.target.id !== d.id) {
              return "inactive";
            }
            return "";
          });

          link.attr("stroke-width", (link_d) => {
            if (link_d.source.id === d.id || link_d.target.id === d.id) {
              return STROKE * 4;
            }
            return STROKE;
          });
          text.attr("class", (text_d) => {
            if (text_d.id !== d.id && !relatedNodesSet.has(text_d.id)) {
              return "inactive";
            }
            return "";
          });
        };

        const onMouseout = function (d) {
          node.attr("class", "");
          link.attr("class", "");
          text.attr("class", "");
          link.attr("stroke-width", STROKE);
        };

        const sameNodes = (previous, next) => {
          if (next.length !== previous.length) {
            return false;
          }

          const map = new Map();
          for (const node of previous) {
            map.set(node.id, node.label);
          }

          for (const node of next) {
            const found = map.get(node.id);
            if (!found || found !== node.title) {
              return false;
            }
          }

          return true;
        };

        const sameEdges = (previous, next) => {
          if (next.length !== previous.length) {
            return false;
          }

          const set = new Set();
          for (const edge of previous) {
            set.add(`${edge.source.id}-${edge.target.id}`);
          }

          for (const edge of next) {
            if (!set.has(`${edge.source.id}-${edge.target.id}`)) {
              return false;
            }
          }

          return true;
        };

        const graphWrapper = document.getElementById('graph-wrapper')
        const element = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        element.setAttribute("width", graphWrapper.getBoundingClientRect().width);
        element.setAttribute("height", window.innerHeight * 0.8);
        graphWrapper.appendChild(element);

        const reportWindowSize = () => {
          element.setAttribute("width", window.innerWidth);
          element.setAttribute("height", window.innerHeight);
        };

        window.onresize = reportWindowSize;

        const svg = d3.select("svg");
        const width = Number(svg.attr("width"));
        const height = Number(svg.attr("height"));
        let zoomLevel = 1;

        const simulation = d3
          .forceSimulation(nodesData)
          .force("forceX", d3.forceX().x(width / 2))
          .force("forceY", d3.forceY().y(height / 2))
          .force("charge", d3.forceManyBody())
          .force(
            "link",
            d3
              .forceLink(linksData)
              .id((d) => d.id)
              .distance(70)
          )
          .force("center", d3.forceCenter(width / 2, height / 2))
          .force("collision", d3.forceCollide().radius(80))
          .stop();

        const g = svg.append("g");
        let link = g.append("g").attr("class", "links").selectAll(".link");
        let node = g.append("g").attr("class", "nodes").selectAll(".node");
        let text = g.append("g").attr("class", "text").selectAll(".text");

        const resize = () => {
          if (d3.event) {
            const scale = d3.event.transform;
            zoomLevel = scale.k;
            g.attr("transform", scale);
          }

          const zoomOrKeep = (value) => (zoomLevel >= 1 ? value / zoomLevel : value);

          const font = Math.max(Math.round(zoomOrKeep(FONT_SIZE)), 1);

          text.attr("font-size", (d) => font);
          text.attr("y", (d) => d.y - zoomOrKeep(FONT_BASELINE) + 8);
          link.attr("stroke-width", zoomOrKeep(STROKE));
          node.attr("r", (d) => {
            return zoomOrKeep(nodeSize[d.id]);
          });
          svg
            .selectAll("circle")
            .filter((_d, i, nodes) => d3.select(nodes[i]).attr("active"))
            .attr("r", (d) => zoomOrKeep(ACTIVE_RADIUS_FACTOR * nodeSize[d.id]));
        };

        const ticked = () => {
          node.attr("cx", (d) => d.x).attr("cy", (d) => d.y);
          text
            .attr("x", (d) => d.x)
            .attr("y", (d) => d.y - (FONT_BASELINE - nodeSize[d.id]) / zoomLevel);
          link
            .attr("x1", (d) => d.source.x)
            .attr("y1", (d) => d.source.y)
            .attr("x2", (d) => d.target.x)
            .attr("y2", (d) => d.target.y);
        };

        const restart = () => {
          updateNodeSize();
          node = node.data(nodesData, (d) => d.id);
          node.exit().remove();
          node = node
            .enter()
            .append("circle")
            .attr("r", (d) => {
              return nodeSize[d.id];
            })
            .on("click", onClick)
            .on("mouseover", onMouseover)
            .on("mouseout", onMouseout)
            .merge(node);

          link = link.data(linksData, (d) => `${d.source.id}-${d.target.id}`);
          link.exit().remove();
          link = link.enter().append("line").attr("stroke-width", STROKE).merge(link);

          text = text.data(nodesData, (d) => d.label);
          text.exit().remove();
          text = text
            .enter()
            .append("text")
            .text((d) => shorten(d.label.replace(/_*/g, ""), MAX_LABEL_LENGTH))
            .attr("font-size", `${FONT_SIZE}px`)
            .attr("text-anchor", "middle")
            .attr("alignment-baseline", "central")
            .on("click", onClick)
            .on("mouseover", onMouseover)
            .on("mouseout", onMouseout)
            .merge(text);

          node.attr("active", (d) => isCurrentPath(d.path) ? true : null);
          text.attr("active", (d) => isCurrentPath(d.path) ? true : null);

          simulation.nodes(nodesData);
          simulation.force("link").links(linksData);
          simulation.alpha(1).restart();
          simulation.stop();

          for (let i = 0; i < TICKS; i++) {
            simulation.tick();
          }

          ticked();
        };

        const zoomHandler = d3.zoom().scaleExtent([0.2, 3]).on("zoom", resize);

        zoomHandler(svg);
        restart();

        function isCurrentPath(notePath) {
          return window.location.pathname.includes(notePath)
        }

        function shorten(str, maxLen, separator = ' ') {
          if (str.length <= maxLen) return str;
          return str.substr(0, str.lastIndexOf(separator, maxLen)) + '...';
        }
      }
    }
  </script>
</div>

</main>
      <footer>


  <footer class="sticky-bottom mt-5" role="contentinfo">
    

    <div class="container">
      
  &copy; Copyright 2025
  Seoyeon
  
  Lee. 
  
  

    </div>
  </footer>

</footer>
    </div>

    <!-- That file is not particularly elegant. This will need a refactor at some point. -->
<style>
  content a.internal-link {
    border-color: #8b88e6;
    background-color: #efefff;
  }

  #tooltip-wrapper {
    background: white;
    padding: 1em;
    border: 1px solid #ddd;
    border-radius: 4px;
    overflow: hidden;
    position: absolute;
    width: 400px;
    height: 250px;
    font-size: 0.8em;
    box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    opacity: 0;
    transition: opacity 100ms;
  }

  #tooltip-wrapper:after {
		content: "";
		position: absolute;
		z-index: 1;
		bottom: 0;
		left: 0;
		pointer-events: none;
		background-image: linear-gradient(to bottom, rgba(255,255,255, 0), rgba(255,255,255, 1) 90%);
		width: 100%;
		height: 75px;
  }
</style>

<div style="opacity: 0; display: none;" id='tooltip-wrapper'>
  <div id='tooltip-content'>
  </div>
</div>

<iframe style="display: none; height: 0; width: 0;" id='link-preview-iframe' src="">
</iframe>

<script>
  var opacityTimeout;
  var contentTimeout;
  var transitionDurationMs = 100;

  var iframe = document.getElementById('link-preview-iframe')
  var tooltipWrapper = document.getElementById('tooltip-wrapper')
  var tooltipContent = document.getElementById('tooltip-content')

  var linkHistories = {};

  function hideTooltip() {
    opacityTimeout = setTimeout(function() {
      tooltipWrapper.style.opacity = 0;
      contentTimeout = setTimeout(function() {
        tooltipContent.innerHTML = '';
        tooltipWrapper.style.display = 'none';
      }, transitionDurationMs + 1);
    }, transitionDurationMs)
  }

  function showTooltip(event) {
    var elem = event.target;
    var elem_props = elem.getClientRects()[elem.getClientRects().length - 1];
    var top = window.pageYOffset || document.documentElement.scrollTop

    if (event.target.host === window.location.host) {
      if (!linkHistories[event.target.href]) {
        iframe.src = event.target.href
        iframe.onload = function() {
          tooltipContentHtml = ''
          tooltipContentHtml += '<div style="font-weight: bold;">' + iframe.contentWindow.document.querySelector('h1').innerHTML + '</div>'
          tooltipContentHtml += iframe.contentWindow.document.querySelector('content').innerHTML

          tooltipContent.innerHTML = tooltipContentHtml
          linkHistories[event.target.href] = tooltipContentHtml

          tooltipWrapper.style.display = 'block';
          setTimeout(function() {
            tooltipWrapper.style.opacity = 1;
          }, 1)
        } 
      } else {
        tooltipContent.innerHTML = linkHistories[event.target.href]
        tooltipWrapper.style.display = 'block';
        setTimeout(function() {
          tooltipWrapper.style.opacity = 1;
        }, 1)
      }


      tooltipWrapper.style.left = elem_props.left - (tooltipWrapper.offsetWidth / 2) + (elem_props.width / 2) + "px";
      if ((window.innerHeight - elem_props.top) < (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top - tooltipWrapper.offsetHeight - 10 + "px";
      } else if ((window.innerHeight - elem_props.top) > (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top + 35 + "px";
      }

      if ((elem_props.left + (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = "10px";
      } else if ((document.body.clientWidth - elem_props.left - (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = document.body.clientWidth - tooltipWrapper.offsetWidth - 20 + "px";
      }
    }
  }

  function setupListeners(linkElement) {
    linkElement.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('touchend', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('touchend', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
      showTooltip(event);
    });

    tooltipWrapper.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
    });
  }

  document.querySelectorAll('content a').forEach(setupListeners);
</script>

  </body>
</html>
